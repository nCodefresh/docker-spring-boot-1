version: '1.0'
steps:
  freestyle_step:
    image: staging.cfcr.io/ncodefresh/dockerspringboot:master
    commands:
      - pwd
      - echo test

  build_step:
    type: build
    title: Building Docker Image
    image_name: ncodefresh/docker-spring-boot
    working_directory: ${{main_clone}}
    dockerfile: Dockerfile.test

#  push_step:
#    type: push
#    title: Test of CFCR
#    candidate: ${{build_step}}
#    registry: cfcr
#    tag: latest

  push_step_2:
    type: push
    title: Push with creds
    candidate: ${{build_step}}
    image_name: ncodefresh/dockerspring-push-creds
    tag: push-creds
    registry: staging.cfcr.io
    credentials:
      username: ${{user}}
      password: ${{pwd}}